define("WoltLabSuite/Core/Conversation/Ui/Participant/Add",["Ajax","Language","Ui/Dialog","Ui/Notification","WoltLabSuite/Core/Ui/ItemList/User"],function(t,e,n,i,a){"use strict";function s(t){this.init(t)}return s.prototype={init:function(e){this._conversationId=e,t.api(this,{actionName:"getAddParticipantsForm"})},_ajaxSetup:function(){return{data:{className:"wcf\\data\\conversation\\ConversationAction",objectIDs:[this._conversationId]}}},_ajaxSuccess:function(t){switch(t.actionName){case"addParticipants":this._handleResponse(t);break;case"getAddParticipantsForm":this._render(t)}},_handleResponse:function(t){if(t.returnValues.errorMessage){var e=elCreate("small");e.className="innerError",e.textContent=t.returnValues.errorMessage;var a=elById("participantsInput").closest(".inputItemList");a.parentNode.insertBefore(e,a.nextSibling);var s=e.nextElementSibling;return void(s&&s.classList.contains("innerError")&&elRemove(s))}t.returnValues.count&&i.show(t.returnValues.successMessage,window.location.reload.bind(window.location)),n.close(this)},_render:function(t){n.open(this,t.returnValues.template);var e=elById("addParticipants");e.disabled=!0,a.init("participantsInput",{callbackChange:function(t,n){e.disabled=0===n.length},excludedSearchValues:t.returnValues.excludedSearchValues,maxItems:t.returnValues.maxItems,includeUserGroups:t.returnValues.canAddGroupParticipants,restrictUserGroupIDs:t.returnValues.restrictUserGroupIDs,csvPerType:!0}),e.addEventListener("click",this._submit.bind(this))},_submit:function(){for(var e=a.getValues("participantsInput"),i=[],s=[],r=0,o=e.length;r<o;r++)"group"===e[r].type?s.push(e[r].objectId):i.push(e[r].value);var c={participants:i,participantsGroupIDs:s},u=elBySel('input[name="messageVisibility"]:checked, input[name="messageVisibility"][type="hidden"]',n.getDialog(this).content);u&&(c.visibility=u.value),t.api(this,{actionName:"addParticipants",parameters:c})},_dialogSetup:function(){return{id:"conversationAddParticipants",options:{title:e.get("wcf.conversation.edit.addParticipants")},source:null}}},s}),define("WoltLabSuite/Core/Conversation/Ui/Subject/Editor",["Ajax","EventKey","Language","Ui/Dialog","Ui/Notification"],function(t,e,n,i,a){"use strict";var s=0,r=null;return{beginEdit:function(t){s=t,i.open(this)},_saveEdit:function(e){e.preventDefault();var i=r.nextElementSibling;i&&i.classList.contains("innerError")&&elRemove(i);var a=r.value.trim();""===a?(i=elCreate("small"),i.className="innerError",i.textContent=n.get("wcf.global.form.error.empty"),r.parentNode.insertBefore(i,r.nextElementSibling)):t.api(this,{parameters:{subject:a},objectIDs:[s]})},_getCurrentValue:function(){var t="";return elBySelAll('.jsConversationSubject[data-conversation-id="'+s+'"], .conversationLink[data-conversation-id="'+s+'"]',void 0,function(e){t=e.textContent}),t},_ajaxSuccess:function(t){i.close(this),elBySelAll('.jsConversationSubject[data-conversation-id="'+s+'"], .conversationLink[data-conversation-id="'+s+'"]',void 0,function(e){e.textContent=t.returnValues.subject}),a.show()},_dialogSetup:function(){return{id:"dialogConversationSubjectEditor",options:{onSetup:function(t){r=elById("jsConversationSubject"),r.addEventListener("keyup",function(t){e.Enter(t)&&this._saveEdit(t)}.bind(this)),elBySel(".jsButtonSave",t).addEventListener(WCF_CLICK_EVENT,this._saveEdit.bind(this))}.bind(this),onShow:function(){r.value=this._getCurrentValue()}.bind(this),title:n.get("wcf.conversation.edit.subject")},source:'<dl><dt><label for="jsConversationSubject">'+n.get("wcf.global.subject")+'</label></dt><dd><input type="text" id="jsConversationSubject" class="long" maxlength="255"></dd></dl><div class="formSubmit"><button class="buttonPrimary jsButtonSave">'+n.get("wcf.global.button.save")+"</button></div>"}},_ajaxSetup:function(){return{data:{actionName:"editSubject",className:"wcf\\data\\conversation\\ConversationAction"}}}}});